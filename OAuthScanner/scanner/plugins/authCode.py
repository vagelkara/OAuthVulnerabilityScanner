from reporter import Reporter
import wfuzz
from utils.utils import get_port,get_host

reporter = Reporter("authCode")

class OAuthCode:
    
    def __init__(self,url, proxy):
        self.url = url
        self.proxy = proxy

    def client_enumeration(self):

        if self.proxy:
            for r in wfuzz.fuzz(url=self.url, proxies=[(get_host(self.proxy['http']),get_port(self.proxy['http']),"HTTP")], hc=[("303"),("404"),("400")], payloads=[("file",dict(fn="./resources/client_id.list"))]):
                reporter.debug(r)
        else:
            print(self.url)
            for r in wfuzz.fuzz(url=self.url, hc=[("303"),("404"),("400")], payloads=[("file",dict(fn="./resources/client_id.list"))]):
                reporter.debug(r)