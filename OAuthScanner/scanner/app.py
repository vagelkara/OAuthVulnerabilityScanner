# from identification_manager import *
from plugin_handler import Plugin_handler
from utils.utils import create_conf,update_conf,clear_conf,repeater,read_settings,remove_key_from_conf
from identification_manager import *
# from utils.temp_server import start_server


class scanner:
    def __init__(self) -> None:
        self.base_url = settings['base_url']
        self.id_manager = identification_manager(self.base_url)
        
    def passive_recon(self):
        self.id_manager.enumerate_server()

    def active_recon(self):
        self.plugin_handler = Plugin_handler(settings)
        self.plugin_handler.active_scan()

settings = read_settings()
oauth_scanner = scanner()
oauth_scanner.passive_recon()
oauth_scanner.active_recon()


