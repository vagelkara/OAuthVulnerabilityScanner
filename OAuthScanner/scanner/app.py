#this is the vulnerability manager
from flask import Flask

# from identification_manager import *
from plugin_handler import Plugin_handler
from utils.utils import create_conf,update_conf,clear_conf,repeater
from identification_manager import *


HOST = "127.0.0.1" # This is overridden by the FLASK_RUN_HOST env var in docker-compose
PORT = 65432  # This is overridden by the FLASK_RUN_PORT env var in docker-compose
app = Flask(__name__)
# clear_conf()

#keycloak
id_manager = identification_manager("http://localhost:8080/realms/master")
#casdoor
# id_manager = identification_manager("http://localhost:8000")
#Glewlwyd ~ not applicable
# id_manager = identification_manager("http://localhost:4593")
#omejdn 
# id_manager = identification_manager("http://localhost:4567")
#a12n-server
# id_manager = identification_manager("http://localhost:8531")
#okta-server
# id_manager = identification_manager("https://dev-62209633.okta.com")

# plugin_handler = Plugin_handler("active_attacker")
# id_manager.find_jwk()

@app.route('/')
def start():
    # repeater()
    id_manager.enumerate_server()
    return "Hello",200

@app.route('/callback')
def malicious_callback():
    return "olleH",200
    

if __name__ == '__main__':
    app.debug = True
    app.run(HOST,PORT)
    app.run(debug=True)