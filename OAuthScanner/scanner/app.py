# from identification_manager import *
from plugin_handler import Plugin_handler
from utils.utils import create_conf,update_conf,clear_conf,repeater,read_settings,remove_key_from_conf
from identification_manager import *
# from utils.temp_server import start_server


class scanner:
    def __init__(self) -> None:
        self.base_url = settings['base_url']
        self.id_manager = identification_manager(self.base_url)
        
    def passive_recon(self):
        success = True
        try:
            self.id_manager.enumerate_server()
        except:
            success = False
        return success

    def active_recon(self):
        self.plugin_handler = Plugin_handler(settings)
        self.plugin_handler.active_scan()

settings = read_settings()
oauth_scanner = scanner()

s = oauth_scanner.passive_recon()
if s:
    oauth_scanner.active_recon()
else:
    reporter.error("Try to investigate it manually since passive scan failed")


